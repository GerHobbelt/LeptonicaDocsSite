<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Leptonica: src/dewarp.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="moller52-tiny.jpg"></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Leptonica&#160;<span id="projectnumber">1.68</span></div>
   <div id="projectbrief">C Image Processing Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('dewarp_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<h1>dewarp.c File Reference</h1>  </div>
</div>
<div class="contents">

<p>Dewarp scanned book pages by generating a vertical disparity array based on textlines.  
<a href="#_details">More...</a></p>
<div class="textblock"><code>#include &lt;math.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="allheaders_8h_source.html">allheaders.h</a>&quot;</code><br/>
</div>
<p><a href="dewarp_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dewarp_8c.html#ad18be613e6673673e5303df308d17e66">DEBUG_TEXTLINE_CENTERS</a>&#160;&#160;&#160;0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dewarp_8c.html#a360b8fabf34a5d978f4624f2d59627d7">DEBUG_SHORT_LINES</a>&#160;&#160;&#160;0</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_l___dewarp.html">L_DEWARP</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dewarp_8c.html#ab3732ef1dea996da9cc7d61ec22f7679">dewarpCreate</a> (<a class="el" href="struct_pix.html">PIX</a> *pixs, <a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a> pageno, <a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a> sampling, <a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a> minlines, <a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a> applyhoriz)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dewarp_8c.html#a6f045fbf4b3cd7abd1bf591a444ad578">dewarpDestroy</a> (<a class="el" href="struct_l___dewarp.html">L_DEWARP</a> **pdew)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dewarp_8c.html#a0026d507fe7f3668adb4c1a40935b4ef">dewarpBuildModel</a> (<a class="el" href="struct_l___dewarp.html">L_DEWARP</a> *dew, <a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a> debugflag)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_ptaa.html">PTAA</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dewarp_8c.html#a40f7425d986ee386118256c5552af2e1">pixGetTextlineCenters</a> (<a class="el" href="struct_pix.html">PIX</a> *pixs, <a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a> debugflag)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_pta.html">PTA</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dewarp_8c.html#a62551436da5029afe3ca1ee2ea229561">pixGetMeanVerticals</a> (<a class="el" href="struct_pix.html">PIX</a> *pixs, <a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a> x, <a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a> y)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_ptaa.html">PTAA</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dewarp_8c.html#a11986e2d6aa276ce7d6313ffb32c0e58">ptaaRemoveShortLines</a> (<a class="el" href="struct_pix.html">PIX</a> *pixs, <a class="el" href="struct_ptaa.html">PTAA</a> *ptaas, <a class="el" href="environ_8h.html#af59419416d96ecf5fca70c8d05adb456">l_float32</a> fract, <a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a> debugflag)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_f_pix.html">FPIX</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dewarp_8c.html#a97ab39152799f67aff65d5e7dbf2e41b">fpixBuildHorizontalDisparity</a> (<a class="el" href="struct_f_pix.html">FPIX</a> *fpixv, <a class="el" href="environ_8h.html#af59419416d96ecf5fca70c8d05adb456">l_float32</a> factor, <a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a> *pextraw)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_f_pix.html">FPIX</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dewarp_8c.html#a8ce00f74fc4d9ede453fa7d5b3a6af84">fpixSampledDisparity</a> (<a class="el" href="struct_f_pix.html">FPIX</a> *fpixs, <a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a> sampling)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dewarp_8c.html#a7ab5f4edbe5de252b075bb1df2c2770c">dewarpApplyDisparity</a> (<a class="el" href="struct_l___dewarp.html">L_DEWARP</a> *dew, <a class="el" href="struct_pix.html">PIX</a> *pixs, <a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a> debugflag)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_pix.html">PIX</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dewarp_8c.html#a2b40c78dd875eec3980384cc6e5673e7">pixApplyVerticalDisparity</a> (<a class="el" href="struct_pix.html">PIX</a> *pixs, <a class="el" href="struct_f_pix.html">FPIX</a> *fpix)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_pix.html">PIX</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dewarp_8c.html#a5edd9b5fe8990c008d062404cad63c9f">pixApplyHorizontalDisparity</a> (<a class="el" href="struct_pix.html">PIX</a> *pixs, <a class="el" href="struct_f_pix.html">FPIX</a> *fpix, <a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a> extraw)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dewarp_8c.html#ab1069c27323d07e4dddab5f3de59fa0e">dewarpMinimize</a> (<a class="el" href="struct_l___dewarp.html">L_DEWARP</a> *dew)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dewarp_8c.html#ab7e72e62f5ca0fbbbc4416cb0066cc26">dewarpPopulateFullRes</a> (<a class="el" href="struct_l___dewarp.html">L_DEWARP</a> *dew)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_l___dewarp.html">L_DEWARP</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dewarp_8c.html#afd745d76986778386eeaef73715ac584">dewarpRead</a> (const char *<a class="el" href="pixserial__reg_8c.html#acbe1cede344a3bc567aea2d2e2ec0b20">filename</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_l___dewarp.html">L_DEWARP</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dewarp_8c.html#a7c42c5bade33d41e4ce249a3b2dc914a">dewarpReadStream</a> (FILE *fp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dewarp_8c.html#ac6089601d0fd423363c5f53cb610df61">dewarpWrite</a> (const char *<a class="el" href="pixserial__reg_8c.html#acbe1cede344a3bc567aea2d2e2ec0b20">filename</a>, <a class="el" href="struct_l___dewarp.html">L_DEWARP</a> *dew)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dewarp_8c.html#aa8e412e6989ef5bb3893feba8e959fd2">dewarpWriteStream</a> (FILE *fp, <a class="el" href="struct_l___dewarp.html">L_DEWARP</a> *dew)</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dewarp_8c.html#ad793119b763d335646cb5f46c3be0554">L_DEFAULT_SAMPLING</a> = 30</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="environ_8h.html#af59419416d96ecf5fca70c8d05adb456">l_float32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dewarp_8c.html#a8ac2b65653d2154442628d17fcd15113">DEFAULT_SLOPE_FACTOR</a> = 2000.</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Dewarp scanned book pages by generating a vertical disparity array based on textlines. </p>
<div class="fragment"><pre class="fragment">    Create/destroy
        <a class="code" href="struct_l___dewarp.html">L_DEWARP</a>      *<a class="code" href="dewarp_8c.html#ab3732ef1dea996da9cc7d61ec22f7679">dewarpCreate</a>()
        void           <a class="code" href="dewarp_8c.html#a6f045fbf4b3cd7abd1bf591a444ad578">dewarpDestroy</a>()

    Build warp model
        <a class="code" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a>        <a class="code" href="dewarp_8c.html#a0026d507fe7f3668adb4c1a40935b4ef">dewarpBuildModel</a>()
        <a class="code" href="struct_ptaa.html">PTAA</a>          *<a class="code" href="dewarp_8c.html#a40f7425d986ee386118256c5552af2e1">pixGetTextlineCenters</a>()
        <a class="code" href="struct_pta.html">PTA</a>           *<a class="code" href="dewarp_8c.html#a62551436da5029afe3ca1ee2ea229561">pixGetMeanVerticals</a>()
        <a class="code" href="struct_ptaa.html">PTAA</a>          *<a class="code" href="dewarp_8c.html#a11986e2d6aa276ce7d6313ffb32c0e58">ptaaRemoveShortLines</a>()
        <a class="code" href="struct_f_pix.html">FPIX</a>          *<a class="code" href="dewarp_8c.html#a97ab39152799f67aff65d5e7dbf2e41b">fpixBuildHorizontalDisparity</a>()
        <a class="code" href="struct_f_pix.html">FPIX</a>          *<a class="code" href="dewarp_8c.html#a8ce00f74fc4d9ede453fa7d5b3a6af84">fpixSampledDisparity</a>()

    Apply warping disparity array
        <a class="code" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a>        <a class="code" href="dewarp_8c.html#a7ab5f4edbe5de252b075bb1df2c2770c">dewarpApplyDisparity</a>()
        <a class="code" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a>        <a class="code" href="dewarp_8c.html#a2b40c78dd875eec3980384cc6e5673e7">pixApplyVerticalDisparity</a>()
        <a class="code" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a>        <a class="code" href="dewarp_8c.html#a5edd9b5fe8990c008d062404cad63c9f">pixApplyHorizontalDisparity</a>()

    Stripping out data and populating full res disparity
        <a class="code" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a>        <a class="code" href="dewarp_8c.html#ab1069c27323d07e4dddab5f3de59fa0e">dewarpMinimize</a>()
        <a class="code" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a>        <a class="code" href="dewarp_8c.html#ab7e72e62f5ca0fbbbc4416cb0066cc26">dewarpPopulateFullRes</a>()

    Serialized I/O
        <a class="code" href="struct_l___dewarp.html">L_DEWARP</a>      *<a class="code" href="dewarp_8c.html#afd745d76986778386eeaef73715ac584">dewarpRead</a>()
        <a class="code" href="struct_l___dewarp.html">L_DEWARP</a>      *<a class="code" href="dewarp_8c.html#a7c42c5bade33d41e4ce249a3b2dc914a">dewarpReadStream</a>()
        <a class="code" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a>        <a class="code" href="dewarp_8c.html#ac6089601d0fd423363c5f53cb610df61">dewarpWrite</a>()
        <a class="code" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a>        <a class="code" href="dewarp_8c.html#aa8e412e6989ef5bb3893feba8e959fd2">dewarpWriteStream</a>()

Basic functioning:
   <a class="code" href="struct_pix.html">Pix</a> *pixb = &quot;binarize&quot;(pixs);
   <a class="code" href="struct_l___dewarp.html">L_Dewarp</a> *dew = <a class="code" href="dewarp_8c.html#ab3732ef1dea996da9cc7d61ec22f7679">dewarpCreate</a>(pixb, ...);
   <a class="code" href="dewarp_8c.html#a0026d507fe7f3668adb4c1a40935b4ef">dewarpBuildModel</a>(dew, 0);
   <a class="code" href="dewarp_8c.html#a7ab5f4edbe5de252b075bb1df2c2770c">dewarpApplyDisparity</a>(dew, pixs, 0);
   <span class="comment">// result is in dew-&gt;pixd;</span>

Minimizing the data in a model by stripping out images,
numas, and full resolution disparity arrays:
   <a class="code" href="dewarp_8c.html#ab1069c27323d07e4dddab5f3de59fa0e">dewarpMinimize</a>(dew);

Applying a model (stripped or not) to another image:
   <a class="code" href="dewarp_8c.html#a7ab5f4edbe5de252b075bb1df2c2770c">dewarpApplyDisparity</a>(dew, newpix, 0);

Description of the problem and the approach
-------------------------------------------

When a book page is scanned, there are several possible causes
for the text lines to appear to be curved:
 (1) A barrel (fish-eye) effect because the camera is at
     a finite distance from the page.  Take the normal from
     the camera to the page (the &#39;optic axis&#39;).  Lines on
     the page &quot;below&quot; this point will appear to curve upward
     (negative curvature); lines &quot;above&quot; this will curve downward.
 (2) Radial distortion from the camera lens.  Probably not
     a big factor.
 (3) Local curvature of the page in to (or out of) the image
     plane (which is perpendicular to the optic axis).
     This has no effect if the page is flat.

The goal is to compute the &quot;disparity&quot; field, D(x,y), which
is actually a vector composed of the horizontal and vertical
disparity fields H(x,y) and V(x,y).  Each of these is a local
function that gives the amount each point in the image is
required to move in order to rectify the horizontal and vertical
lines.

Effects (1) and (2) can be compensated for by calibrating
the scene, using a flat page with horizontal and vertical lines.
Then H(x,y) and V(x,y) can be found as two (non-parametric) arrays
of values.  Suppose this has been done.  Then the remaining
distortion is due to (3).

Now, if we knew everywhere the angle between the perpendicular
to the paper and the optic axis (call it &#39;alpha&#39;), the
actual shape of the page could in principle be found by integration,
and the remaining disparities, H(x,y) and V(x,y), could be
found.  But we don&#39;t know alpha.  If there are text lines on
the page, we can assume they should be horizontal, so we can
compute the vertical disparity, which is the local translation
required to make the text lines parallel to the rasters.

The basic question relating to (3) is this:

   Is it possible, using the shape of the text lines alone,
   to compute both the vertical and horizontal disparity fields?

The problem is to find H(x,y).  In an image with horizontal
text lines, the only vertical &quot;lines&quot; that we can infer are
perhaps the left and right margins.

Start with a simple case.  Suppose the binding is along a
vertical line, and the page curvature is independent of y.
Then if the page curves in toward the binding, there will be
a fractional foreshortening of that region in the x-direction, going
as the sine of the angle between the optic axis and local the
normal to the page.  For this situation, the horizontal
disparity is independent of y: H(x,y) == H(x).

Now consider V(x,0) and V(x,h), the vertical disparity along
the top and bottom of the image.  With a little thought you
can convince yourself that the local foreshortening,
as a function of x, is proportional to the difference
between the slope of V(x,0) and V(x,h).  The horizontal
disparity can then be computed by integrating the local foreshortening
over x.  Integration of the slope of V(x,0) and V(x,h) gives
the vertical disparity itself.  We have to normalize to h, the
height of the page.  So the very simple result is that

    H(x) ~ (V(x,0) - V(x,h)) / h         [1]

which is easily computed.  There is a proportionality constant
that depends on the ratio of h to the distance to the camera.
Can we actually believe this for the case where the bending
is independent of y?  I believe the answer is yes,
as <span class="keywordtype">long</span> as you first remove the apparent distortion due
to the camera being at a finite distance.

If you know the intersection of the optical axis with the page
and the distance to the camera, and if the page is perpendicular
to the optic axis, you can compute the horizontal and vertical
disparities due to (1) and (2) and remove them.  The resulting
distortion should be entirely due to bending (3), for which
the relation

    Hx(x) dx = C * ((Vx(x,0) - Vx(x, h))/h) dx         [2]

holds for each point in x (Hx and Vx are partial derivatives w/rt x).
Integrating over x, and using H(0) = 0, we get the result [1].

I believe this result holds differentially for each value of y, so
that in the case where the bending is not independent of y,
the expression (V(x,0) - V(x,h)) / h goes over to Vy(x,y).  Then

   H(x,y) = Integral(0,x) (Vyx(x,y) dx)         [3]

where Vyx() is the partial derivative of V w/rt both x and y.

There should be a simple mathematical relation between
the horizontal and vertical disparities for the situation
where the paper bends without stretching or kinking.
I was hoping that we would get a relation between H and V such
as Hx(x,y) ~ Vy(x,y), which would imply that H and V are real
and imaginary parts of a complex potential, each of which
satisfy the laplace equation.  But then the gradients of the
two potentials would be normal, and that does not appear to be the case.
Thus, the questions of proving the relations above (for small bending),
or finding a simpler relation between H and V than those equations,
remain open.  So far, we have only used [1] for the horizontal
disparity H(x).

In the <a class="code" href="src_2xtractprotos_8c.html#aa31f487a99743d24af9076a3e11e5425">version</a> of the code that follows, we use text lines
to find V(x,y), and then, optionally, approximate H(x)
from the values V(x,0) and V(x,h), as described above.
The details are all in the code, but here is the basic outline.
We assume that in the plane perpendicular to the optic axis
(alpha = 0), horizontal and vertical lines have been rectified.
(If not, they can be rectified using the methods described below,
applied separately as steps (1,2,3) in the horizontal and
vertical directions.)

(1) Find lines going approximately through the center of the
    text in each text line.  Accept only lines that are
    close in length to the longest line.
(2) Generate a regular and highly subsampled vertical
    disparity field V(x,y).
(3) Interpolate this to generate a full resolution vertical
    disparity field.
(4) Optionally generate a full resolution horizontal disparity
    field, H(x).
(5) Apply the vertical dewarping, followed optionally by the
    horizontal dewarping.

Step (1) is clearly described by the code in <a class="code" href="dewarp_8c.html#a40f7425d986ee386118256c5552af2e1">pixGetTextlineCenters</a>().

Steps (2) and (3) follow directly from the data in step (1),
and constitute the bulk of the work done in <a class="code" href="dewarp_8c.html#a0026d507fe7f3668adb4c1a40935b4ef">dewarpBuildModel</a>().
Virtually all the noise in the data is smoothed out by doing
least-square quadratic fits, first horizontally to the data
points representing the text line centers, and then vertically.
The trick is to sample these lines on a regular grid.
First each horizontal line is sampled at equally spaced
intervals horizontally.  We thus get a set of points,
one in each line, that are vertically aligned, and
the data we represent is the vertical distance of each point
from the min or max value on the curve, depending on the
sign of the curvature component.  Each of these vertically
aligned sets of points constitutes a sampled vertical disparity,
and we do a LS quartic fit to each of them, followed by
vertical sampling at regular intervals.  We now have a subsampled
grid of points, all equally spaced, giving at each point the local
vertical disparity.  Finally, the full resolution vertical disparity
is formed by interpolation.  All the least square fits do a
great job of smoothing everything out, as can be observed by
the contour maps that are generated for the vertical disparity field.

Step (4) is trivially done with the approximation described above.
Once V(x,y) and H(x,y) are derived, step (5) is done trivially.
For vertical dewarp, source pixels at the top and bottom image
boundaries are used whenever a request is made for a pixel that
is outside the image.  For horizontal dewarp, the dest image width
is increased to hold all transformed source pixels (remember,
in that step, the image is widened).
</pre></div> 
<p>Definition in file <a class="el" href="dewarp_8c_source.html">dewarp.c</a>.</p>
</div><hr/><h2>Define Documentation</h2>
<a class="anchor" id="ad18be613e6673673e5303df308d17e66"></a><!-- doxytag: member="dewarp.c::DEBUG_TEXTLINE_CENTERS" ref="ad18be613e6673673e5303df308d17e66" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEBUG_TEXTLINE_CENTERS&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="dewarp_8c_source.html#l00225">225</a> of file <a class="el" href="dewarp_8c_source.html">dewarp.c</a>.</p>

<p>Referenced by <a class="el" href="dewarp_8c_source.html#l00369">dewarpBuildModel()</a>.</p>

</div>
</div>
<a class="anchor" id="a360b8fabf34a5d978f4624f2d59627d7"></a><!-- doxytag: member="dewarp.c::DEBUG_SHORT_LINES" ref="a360b8fabf34a5d978f4624f2d59627d7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEBUG_SHORT_LINES&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="dewarp_8c_source.html#l00226">226</a> of file <a class="el" href="dewarp_8c_source.html">dewarp.c</a>.</p>

<p>Referenced by <a class="el" href="dewarp_8c_source.html#l00369">dewarpBuildModel()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ab3732ef1dea996da9cc7d61ec22f7679"></a><!-- doxytag: member="dewarp.c::dewarpCreate" ref="ab3732ef1dea996da9cc7d61ec22f7679" args="(PIX *pixs, l_int32 pageno, l_int32 sampling, l_int32 minlines, l_int32 applyhoriz)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_l___dewarp.html">L_DEWARP</a>* dewarpCreate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_pix.html">PIX</a> *&#160;</td>
          <td class="paramname"><em>pixs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a>&#160;</td>
          <td class="paramname"><em>pageno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a>&#160;</td>
          <td class="paramname"><em>sampling</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a>&#160;</td>
          <td class="paramname"><em>minlines</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a>&#160;</td>
          <td class="paramname"><em>applyhoriz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="dewarp_8c.html#ab3732ef1dea996da9cc7d61ec22f7679">dewarpCreate()</a></p>
<p>Input: pixs (1 bpp) pageno (page number) sampling (use -1 or 0 for default value; otherwise minimum of 5) minlines (minimum number of lines to accept; e.g., 10) applyhoriz (1 to estimate horiz disparity; 0 to skip) Return: dew (or null on error)</p>
<p>Notes: (1) The page number is typically 0-based. If scanned from a book, the even pages are usually on the left. Disparity arrays built for even pages should only be applied to even pages. (2) The sampling factor is for the disparity array. The number used is not critical; anything between 10 and 60 should be fine. (3) The minimum number of nearly full-length lines required to generate a vertical disparity array. Use a small number if you are willing to accept a questionable array. </p>

<p>Definition at line <a class="el" href="dewarp_8c_source.html#l00261">261</a> of file <a class="el" href="dewarp_8c_source.html">dewarp.c</a>.</p>

<p>References <a class="el" href="dewarp_8h_source.html#l00049">L_Dewarp::applyhoriz</a>, <a class="el" href="environ_8h_source.html#l00214">CALLOC</a>, <a class="el" href="environ_8h_source.html#l00250">ERROR_PTR</a>, <a class="el" href="dewarp_8c_source.html#l00233">L_DEFAULT_SAMPLING</a>, <a class="el" href="environ_8h_source.html#l00257">L_WARNING</a>, <a class="el" href="dewarp_8h_source.html#l00048">L_Dewarp::minlines</a>, <a class="el" href="environ_8h_source.html#l00171">NULL</a>, <a class="el" href="dewarp_8h_source.html#l00050">L_Dewarp::nx</a>, <a class="el" href="dewarp_8h_source.html#l00051">L_Dewarp::ny</a>, <a class="el" href="dewarp_8h_source.html#l00046">L_Dewarp::pageno</a>, <a class="el" href="pix1_8c_source.html#l00440">pixClone()</a>, <a class="el" href="pix1_8c_source.html#l00863">pixGetDepth()</a>, <a class="el" href="pix1_8c_source.html#l00898">pixGetDimensions()</a>, <a class="el" href="dewarp_8h_source.html#l00038">L_Dewarp::pixs</a>, <a class="el" href="environ_8h_source.html#l00249">PROCNAME</a>, and <a class="el" href="dewarp_8h_source.html#l00047">L_Dewarp::sampling</a>.</p>

<p>Referenced by <a class="el" href="dewarp__reg_8c_source.html#l00027">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a6f045fbf4b3cd7abd1bf591a444ad578"></a><!-- doxytag: member="dewarp.c::dewarpDestroy" ref="a6f045fbf4b3cd7abd1bf591a444ad578" args="(L_DEWARP **pdew)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dewarpDestroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_l___dewarp.html">L_DEWARP</a> **&#160;</td>
          <td class="paramname"><em>pdew</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="dewarp_8c.html#a6f045fbf4b3cd7abd1bf591a444ad578">dewarpDestroy()</a></p>
<p>Input: &amp;dew (&lt;will be="" set="" to="" null="" before="" returning&gt;=""&gt;) Return: void </p>

<p>Definition at line <a class="el" href="dewarp_8c_source.html#l00309">309</a> of file <a class="el" href="dewarp_8c_source.html">dewarp.c</a>.</p>

<p>References <a class="el" href="fpix1_8c_source.html#l00326">fpixDestroy()</a>, <a class="el" href="environ_8h_source.html#l00216">FREE</a>, <a class="el" href="dewarp_8h_source.html#l00043">L_Dewarp::fullhdispar</a>, <a class="el" href="dewarp_8h_source.html#l00042">L_Dewarp::fullvdispar</a>, <a class="el" href="environ_8h_source.html#l00257">L_WARNING</a>, <a class="el" href="dewarp_8h_source.html#l00045">L_Dewarp::nacurves</a>, <a class="el" href="dewarp_8h_source.html#l00044">L_Dewarp::naflats</a>, <a class="el" href="environ_8h_source.html#l00171">NULL</a>, <a class="el" href="numabasic_8c_source.html#l00292">numaDestroy()</a>, <a class="el" href="dewarp_8h_source.html#l00039">L_Dewarp::pixd</a>, <a class="el" href="pix1_8c_source.html#l00466">pixDestroy()</a>, <a class="el" href="dewarp_8h_source.html#l00038">L_Dewarp::pixs</a>, <a class="el" href="environ_8h_source.html#l00249">PROCNAME</a>, <a class="el" href="dewarp_8h_source.html#l00041">L_Dewarp::samphdispar</a>, and <a class="el" href="dewarp_8h_source.html#l00040">L_Dewarp::sampvdispar</a>.</p>

<p>Referenced by <a class="el" href="dewarp__reg_8c_source.html#l00027">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a0026d507fe7f3668adb4c1a40935b4ef"></a><!-- doxytag: member="dewarp.c::dewarpBuildModel" ref="a0026d507fe7f3668adb4c1a40935b4ef" args="(L_DEWARP *dew, l_int32 debugflag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a> dewarpBuildModel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_l___dewarp.html">L_DEWARP</a> *&#160;</td>
          <td class="paramname"><em>dew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a>&#160;</td>
          <td class="paramname"><em>debugflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="dewarp_8c.html#a0026d507fe7f3668adb4c1a40935b4ef">dewarpBuildModel()</a></p>
<p>Input: dew debugflag (1 for debugging output) Return: 0 if OK, 1 on error</p>
<p>Notes: (1) This is the basic function that builds the vertical disparity array, which allows determination of the src pixel in the input image corresponding to each dest pixel in the dewarped image. (2) The method is as follows: * Estimate the centers of all the long textlines and fit a LS quadratic to each one. This smooths the curves. * Sample each curve at a regular interval, find the y-value of the flat point on each curve, and subtract the sampled curve value from this value. This is the vertical disparity. * Fit a LS quadratic to each set of vertically aligned disparity samples. This smooths the disparity values in the vertical direction. Then resample at the same regular interval, We now have a regular grid of smoothed vertical disparity valuels. * Interpolate this grid to get a full resolution disparity map. This can be applied directly to the src image pixels to dewarp the image in the vertical direction, making all textlines horizontal. </p>

<p>Definition at line <a class="el" href="dewarp_8c_source.html#l00369">369</a> of file <a class="el" href="dewarp_8c_source.html">dewarp.c</a>.</p>

<p>References <a class="el" href="dewarp_8h_source.html#l00049">L_Dewarp::applyhoriz</a>, <a class="el" href="ptafunc1_8c_source.html#l01284">applyQuadraticFit()</a>, <a class="el" href="dewarp_8c_source.html#l00226">DEBUG_SHORT_LINES</a>, <a class="el" href="dewarp_8c_source.html#l00225">DEBUG_TEXTLINE_CENTERS</a>, <a class="el" href="environ_8h_source.html#l00251">ERROR_INT</a>, <a class="el" href="dewarp_8h_source.html#l00052">L_Dewarp::extraw</a>, <a class="el" href="dewarp_8c_source.html#l00818">fpixBuildHorizontalDisparity()</a>, <a class="el" href="fpix1_8c_source.html#l00125">fpixCreate()</a>, <a class="el" href="graphics_8c_source.html#l01712">fpixRenderContours()</a>, <a class="el" href="dewarp_8c_source.html#l00892">fpixSampledDisparity()</a>, <a class="el" href="fpix2_8c_source.html#l00785">fpixScaleByInteger()</a>, <a class="el" href="fpix1_8c_source.html#l00567">fpixSetPixel()</a>, <a class="el" href="environ_8h_source.html#l00216">FREE</a>, <a class="el" href="dewarp_8h_source.html#l00043">L_Dewarp::fullhdispar</a>, <a class="el" href="dewarp_8h_source.html#l00042">L_Dewarp::fullvdispar</a>, <a class="el" href="utils_8c_source.html#l02816">genTempFilename()</a>, <a class="el" href="imageio_8h_source.html#l00038">IFF_PNG</a>, <a class="el" href="pix_8h_source.html#l00598">L_CLONE</a>, <a class="el" href="pix_8h_source.html#l00596">L_INSERT</a>, <a class="el" href="pix_8h_source.html#l00602">L_NOCOPY</a>, <a class="el" href="pix_8h_source.html#l00609">L_SORT_INCREASING</a>, <a class="el" href="dewarp_8h_source.html#l00045">L_Dewarp::nacurves</a>, <a class="el" href="dewarp_8h_source.html#l00044">L_Dewarp::naflats</a>, <a class="el" href="environ_8h_source.html#l00171">NULL</a>, <a class="el" href="numabasic_8c_source.html#l00403">numaAddNumber()</a>, <a class="el" href="numabasic_8c_source.html#l00177">numaCreate()</a>, <a class="el" href="numabasic_8c_source.html#l00292">numaDestroy()</a>, <a class="el" href="numabasic_8c_source.html#l00781">numaGetFArray()</a>, <a class="el" href="numabasic_8c_source.html#l00614">numaGetFValue()</a>, <a class="el" href="numafunc1_8c_source.html#l02107">numaGetSortIndex()</a>, <a class="el" href="numafunc1_8c_source.html#l02169">numaSortByIndex()</a>, <a class="el" href="numabasic_8c_source.html#l01000">numaWrite()</a>, <a class="el" href="dewarp_8h_source.html#l00050">L_Dewarp::nx</a>, <a class="el" href="pixaatest_8c_source.html#l00026">nx</a>, <a class="el" href="dewarp_8h_source.html#l00051">L_Dewarp::ny</a>, <a class="el" href="pixaatest_8c_source.html#l00027">ny</a>, <a class="el" href="pixconv_8c_source.html#l02453">pixConvertTo32()</a>, <a class="el" href="pix1_8c_source.html#l00466">pixDestroy()</a>, <a class="el" href="writefile_8c_source.html#l00677">pixDisplay()</a>, <a class="el" href="ptafunc1_8c_source.html#l01737">pixDisplayPtaa()</a>, <a class="el" href="writefile_8c_source.html#l00699">pixDisplayWithTitle()</a>, <a class="el" href="dewarp_8c_source.html#l00620">pixGetTextlineCenters()</a>, <a class="el" href="dewarp_8h_source.html#l00038">L_Dewarp::pixs</a>, <a class="el" href="writefile_8c_source.html#l00434">pixWriteTempfile()</a>, <a class="el" href="environ_8h_source.html#l00249">PROCNAME</a>, <a class="el" href="ptabasic_8c_source.html#l00726">ptaaAddPta()</a>, <a class="el" href="ptabasic_8c_source.html#l00661">ptaaCreate()</a>, <a class="el" href="ptabasic_8c_source.html#l00262">ptaAddPt()</a>, <a class="el" href="ptabasic_8c_source.html#l00689">ptaaDestroy()</a>, <a class="el" href="ptabasic_8c_source.html#l00797">ptaaGetCount()</a>, <a class="el" href="ptabasic_8c_source.html#l00848">ptaaGetPt()</a>, <a class="el" href="ptabasic_8c_source.html#l00817">ptaaGetPta()</a>, <a class="el" href="dewarp_8c_source.html#l00743">ptaaRemoveShortLines()</a>, <a class="el" href="ptafunc1_8c_source.html#l00401">ptaaSortByIndex()</a>, <a class="el" href="ptabasic_8c_source.html#l00955">ptaaWrite()</a>, <a class="el" href="ptabasic_8c_source.html#l00083">ptaCreate()</a>, <a class="el" href="ptabasic_8c_source.html#l00115">ptaCreateFromNuma()</a>, <a class="el" href="ptabasic_8c_source.html#l00156">ptaDestroy()</a>, <a class="el" href="ptabasic_8c_source.html#l00456">ptaGetArrays()</a>, <a class="el" href="ptabasic_8c_source.html#l00367">ptaGetPt()</a>, <a class="el" href="ptafunc1_8c_source.html#l00892">ptaGetQuadraticLSF()</a>, <a class="el" href="ptafunc1_8c_source.html#l00487">ptaGetRange()</a>, <a class="el" href="dewarp_8h_source.html#l00041">L_Dewarp::samphdispar</a>, <a class="el" href="dewarp_8h_source.html#l00047">L_Dewarp::sampling</a>, <a class="el" href="dewarp_8h_source.html#l00040">L_Dewarp::sampvdispar</a>, <a class="el" href="dewarp_8h_source.html#l00053">L_Dewarp::success</a>, and <a class="el" href="conncomp_8c_source.html#l00093">FillSeg::y</a>.</p>

<p>Referenced by <a class="el" href="dewarp__reg_8c_source.html#l00027">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a40f7425d986ee386118256c5552af2e1"></a><!-- doxytag: member="dewarp.c::pixGetTextlineCenters" ref="a40f7425d986ee386118256c5552af2e1" args="(PIX *pixs, l_int32 debugflag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_ptaa.html">PTAA</a>* pixGetTextlineCenters </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_pix.html">PIX</a> *&#160;</td>
          <td class="paramname"><em>pixs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a>&#160;</td>
          <td class="paramname"><em>debugflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="dewarp_8c.html#a40f7425d986ee386118256c5552af2e1">pixGetTextlineCenters()</a></p>
<p>Input: pixs (1 bpp) debugflag (1 for debug output) Return: ptaa (of center values of textlines)</p>
<p>Notes: (1) This in general does not have a point for each value of x, because there will be gaps between words. It doesn't matter because we will fit a quadratic to the points that we do have. </p>

<p>Definition at line <a class="el" href="dewarp_8c_source.html#l00620">620</a> of file <a class="el" href="dewarp_8c_source.html">dewarp.c</a>.</p>

<p>References <a class="el" href="boxbasic_8c_source.html#l00436">boxaDestroy()</a>, <a class="el" href="environ_8h_source.html#l00250">ERROR_PTR</a>, <a class="el" href="pix_8h_source.html#l00598">L_CLONE</a>, <a class="el" href="pix_8h_source.html#l00596">L_INSERT</a>, <a class="el" href="pix_8h_source.html#l00661">L_SELECT_IF_BOTH</a>, <a class="el" href="pix_8h_source.html#l00666">L_SELECT_IF_GT</a>, <a class="el" href="environ_8h_source.html#l00171">NULL</a>, <a class="el" href="pixabasic_8c_source.html#l00333">pixaDestroy()</a>, <a class="el" href="pixafunc2_8c_source.html#l00110">pixaDisplay()</a>, <a class="el" href="pixabasic_8c_source.html#l00746">pixaGetBoxGeometry()</a>, <a class="el" href="pixabasic_8c_source.html#l00554">pixaGetCount()</a>, <a class="el" href="pixabasic_8c_source.html#l00594">pixaGetPix()</a>, <a class="el" href="pixafunc1_8c_source.html#l00247">pixaSelectBySize()</a>, <a class="el" href="conncomp_8c_source.html#l00132">pixConnComp()</a>, <a class="el" href="pix1_8c_source.html#l00328">pixCreateTemplate()</a>, <a class="el" href="pix1_8c_source.html#l00466">pixDestroy()</a>, <a class="el" href="ptafunc1_8c_source.html#l01737">pixDisplayPtaa()</a>, <a class="el" href="writefile_8c_source.html#l00699">pixDisplayWithTitle()</a>, <a class="el" href="pix1_8c_source.html#l00863">pixGetDepth()</a>, <a class="el" href="pix1_8c_source.html#l00898">pixGetDimensions()</a>, <a class="el" href="dewarp_8c_source.html#l00697">pixGetMeanVerticals()</a>, <a class="el" href="morphseq_8c_source.html#l00118">pixMorphSequence()</a>, <a class="el" href="environ_8h_source.html#l00249">PROCNAME</a>, <a class="el" href="ptabasic_8c_source.html#l00726">ptaaAddPta()</a>, and <a class="el" href="ptabasic_8c_source.html#l00661">ptaaCreate()</a>.</p>

<p>Referenced by <a class="el" href="dewarp_8c_source.html#l00369">dewarpBuildModel()</a>, and <a class="el" href="dewarp__reg_8c_source.html#l00027">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a62551436da5029afe3ca1ee2ea229561"></a><!-- doxytag: member="dewarp.c::pixGetMeanVerticals" ref="a62551436da5029afe3ca1ee2ea229561" args="(PIX *pixs, l_int32 x, l_int32 y)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_pta.html">PTA</a>* pixGetMeanVerticals </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_pix.html">PIX</a> *&#160;</td>
          <td class="paramname"><em>pixs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a>&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a>&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>ptaGetMeanVerticals()</p>
<p>Input: pixs (1 bpp, single c.c.) x,y (location of UL corner of pixs with respect to page image Return: pta (mean y-values in component for each x-value, both translated by (x,y) </p>

<p>Definition at line <a class="el" href="dewarp_8c_source.html#l00697">697</a> of file <a class="el" href="dewarp_8c_source.html">dewarp.c</a>.</p>

<p>References <a class="el" href="environ_8h_source.html#l00250">ERROR_PTR</a>, <a class="el" href="arrayaccess_8h_source.html#l00060">GET_DATA_BIT</a>, <a class="el" href="environ_8h_source.html#l00171">NULL</a>, <a class="el" href="pix1_8c_source.html#l01358">pixGetData()</a>, <a class="el" href="pix1_8c_source.html#l00863">pixGetDepth()</a>, <a class="el" href="pix1_8c_source.html#l00898">pixGetDimensions()</a>, <a class="el" href="pix1_8c_source.html#l00970">pixGetWpl()</a>, <a class="el" href="environ_8h_source.html#l00249">PROCNAME</a>, <a class="el" href="ptabasic_8c_source.html#l00262">ptaAddPt()</a>, and <a class="el" href="ptabasic_8c_source.html#l00083">ptaCreate()</a>.</p>

<p>Referenced by <a class="el" href="dewarp_8c_source.html#l00620">pixGetTextlineCenters()</a>.</p>

</div>
</div>
<a class="anchor" id="a11986e2d6aa276ce7d6313ffb32c0e58"></a><!-- doxytag: member="dewarp.c::ptaaRemoveShortLines" ref="a11986e2d6aa276ce7d6313ffb32c0e58" args="(PIX *pixs, PTAA *ptaas, l_float32 fract, l_int32 debugflag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_ptaa.html">PTAA</a>* ptaaRemoveShortLines </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_pix.html">PIX</a> *&#160;</td>
          <td class="paramname"><em>pixs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_ptaa.html">PTAA</a> *&#160;</td>
          <td class="paramname"><em>ptaas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="environ_8h.html#af59419416d96ecf5fca70c8d05adb456">l_float32</a>&#160;</td>
          <td class="paramname"><em>fract</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a>&#160;</td>
          <td class="paramname"><em>debugflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="dewarp_8c.html#a11986e2d6aa276ce7d6313ffb32c0e58">ptaaRemoveShortLines()</a></p>
<p>Input: pixs (1 bpp) ptaas (input lines) fract (minimum fraction of longest line to keep) debugflag Return: ptaad (containing only lines of sufficient length), or null on error </p>

<p>Definition at line <a class="el" href="dewarp_8c_source.html#l00743">743</a> of file <a class="el" href="dewarp_8c_source.html">dewarp.c</a>.</p>

<p>References <a class="el" href="environ_8h_source.html#l00250">ERROR_PTR</a>, <a class="el" href="pix_8h_source.html#l00598">L_CLONE</a>, <a class="el" href="pix_8h_source.html#l00596">L_INSERT</a>, <a class="el" href="pix_8h_source.html#l00610">L_SORT_DECREASING</a>, <a class="el" href="environ_8h_source.html#l00257">L_WARNING</a>, <a class="el" href="environ_8h_source.html#l00171">NULL</a>, <a class="el" href="numabasic_8c_source.html#l00403">numaAddNumber()</a>, <a class="el" href="numabasic_8c_source.html#l00177">numaCreate()</a>, <a class="el" href="numabasic_8c_source.html#l00292">numaDestroy()</a>, <a class="el" href="numabasic_8c_source.html#l00647">numaGetIValue()</a>, <a class="el" href="numafunc1_8c_source.html#l02107">numaGetSortIndex()</a>, <a class="el" href="pix1_8c_source.html#l00548">pixCopy()</a>, <a class="el" href="pix1_8c_source.html#l00466">pixDestroy()</a>, <a class="el" href="ptafunc1_8c_source.html#l01737">pixDisplayPtaa()</a>, <a class="el" href="writefile_8c_source.html#l00699">pixDisplayWithTitle()</a>, <a class="el" href="pix1_8c_source.html#l00863">pixGetDepth()</a>, <a class="el" href="pix1_8c_source.html#l00898">pixGetDimensions()</a>, <a class="el" href="environ_8h_source.html#l00249">PROCNAME</a>, <a class="el" href="ptabasic_8c_source.html#l00726">ptaaAddPta()</a>, <a class="el" href="ptabasic_8c_source.html#l00661">ptaaCreate()</a>, <a class="el" href="ptabasic_8c_source.html#l00797">ptaaGetCount()</a>, <a class="el" href="ptabasic_8c_source.html#l00817">ptaaGetPta()</a>, <a class="el" href="ptabasic_8c_source.html#l00156">ptaDestroy()</a>, and <a class="el" href="ptafunc1_8c_source.html#l00487">ptaGetRange()</a>.</p>

<p>Referenced by <a class="el" href="dewarp_8c_source.html#l00369">dewarpBuildModel()</a>, and <a class="el" href="dewarp__reg_8c_source.html#l00027">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a97ab39152799f67aff65d5e7dbf2e41b"></a><!-- doxytag: member="dewarp.c::fpixBuildHorizontalDisparity" ref="a97ab39152799f67aff65d5e7dbf2e41b" args="(FPIX *fpixv, l_float32 factor, l_int32 *pextraw)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_f_pix.html">FPIX</a>* fpixBuildHorizontalDisparity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_f_pix.html">FPIX</a> *&#160;</td>
          <td class="paramname"><em>fpixv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="environ_8h.html#af59419416d96ecf5fca70c8d05adb456">l_float32</a>&#160;</td>
          <td class="paramname"><em>factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a> *&#160;</td>
          <td class="paramname"><em>pextraw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="dewarp_8c.html#a97ab39152799f67aff65d5e7dbf2e41b">fpixBuildHorizontalDisparity()</a></p>
<p>Input: fpixv (vertical disparity model) factor (conversion factor for vertical disparity slope; use 0 for default) &amp;extraw (&lt;return&gt; extra width to be added to dewarped pix) Return: fpixh, or null on error</p>
<p>Notes: (1) This takes the difference in vertical disparity at top and bottom of the image, and converts it to an assumed horizontal disparity. </p>

<p>Definition at line <a class="el" href="dewarp_8c_source.html#l00818">818</a> of file <a class="el" href="dewarp_8c_source.html">dewarp.c</a>.</p>

<p>References <a class="el" href="dewarp_8c_source.html#l00234">DEFAULT_SLOPE_FACTOR</a>, <a class="el" href="environ_8h_source.html#l00250">ERROR_PTR</a>, <a class="el" href="fpix1_8c_source.html#l00125">fpixCreate()</a>, <a class="el" href="fpix1_8c_source.html#l00499">fpixGetData()</a>, <a class="el" href="fpix1_8c_source.html#l00365">fpixGetDimensions()</a>, <a class="el" href="fpix1_8c_source.html#l00532">fpixGetPixel()</a>, <a class="el" href="fpix1_8c_source.html#l00402">fpixGetWpl()</a>, <a class="el" href="pix_8h_source.html#l00602">L_NOCOPY</a>, <a class="el" href="environ_8h_source.html#l00171">NULL</a>, <a class="el" href="numabasic_8c_source.html#l00403">numaAddNumber()</a>, <a class="el" href="numabasic_8c_source.html#l00177">numaCreate()</a>, <a class="el" href="numabasic_8c_source.html#l00292">numaDestroy()</a>, <a class="el" href="numabasic_8c_source.html#l00781">numaGetFArray()</a>, <a class="el" href="numafunc1_8c_source.html#l00354">numaGetMax()</a>, and <a class="el" href="environ_8h_source.html#l00249">PROCNAME</a>.</p>

<p>Referenced by <a class="el" href="dewarp_8c_source.html#l00369">dewarpBuildModel()</a>.</p>

</div>
</div>
<a class="anchor" id="a8ce00f74fc4d9ede453fa7d5b3a6af84"></a><!-- doxytag: member="dewarp.c::fpixSampledDisparity" ref="a8ce00f74fc4d9ede453fa7d5b3a6af84" args="(FPIX *fpixs, l_int32 sampling)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_f_pix.html">FPIX</a>* fpixSampledDisparity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_f_pix.html">FPIX</a> *&#160;</td>
          <td class="paramname"><em>fpixs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a>&#160;</td>
          <td class="paramname"><em>sampling</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="dewarp_8c.html#a8ce00f74fc4d9ede453fa7d5b3a6af84">fpixSampledDisparity()</a></p>
<p>Input: fpixs (full resolution disparity model) sampling (sampling factor) Return: fpixd (sampled disparity model), or null on error</p>
<p>Notes: (1) The input array is sampled at the right and top edges, and at every  pixels horizontally and vertically. (2) The sampled array is constructed large enough to (a) cover fpixs and (b) have the sampled grid on all boundary pixels in fpixd. Having sampled pixels around the boundary simplifies interpolation. (3) There must be at least 3 sampled points horizontally and vertically. </p>

<p>Definition at line <a class="el" href="dewarp_8c_source.html#l00892">892</a> of file <a class="el" href="dewarp_8c_source.html">dewarp.c</a>.</p>

<p>References <a class="el" href="environ_8h_source.html#l00214">CALLOC</a>, <a class="el" href="environ_8h_source.html#l00250">ERROR_PTR</a>, <a class="el" href="fpix1_8c_source.html#l00125">fpixCreate()</a>, <a class="el" href="fpix1_8c_source.html#l00365">fpixGetDimensions()</a>, <a class="el" href="fpix1_8c_source.html#l00532">fpixGetPixel()</a>, <a class="el" href="fpix1_8c_source.html#l00567">fpixSetPixel()</a>, <a class="el" href="environ_8h_source.html#l00216">FREE</a>, <a class="el" href="environ_8h_source.html#l00171">NULL</a>, and <a class="el" href="environ_8h_source.html#l00249">PROCNAME</a>.</p>

<p>Referenced by <a class="el" href="dewarp_8c_source.html#l00369">dewarpBuildModel()</a>.</p>

</div>
</div>
<a class="anchor" id="a7ab5f4edbe5de252b075bb1df2c2770c"></a><!-- doxytag: member="dewarp.c::dewarpApplyDisparity" ref="a7ab5f4edbe5de252b075bb1df2c2770c" args="(L_DEWARP *dew, PIX *pixs, l_int32 debugflag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a> dewarpApplyDisparity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_l___dewarp.html">L_DEWARP</a> *&#160;</td>
          <td class="paramname"><em>dew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_pix.html">PIX</a> *&#160;</td>
          <td class="paramname"><em>pixs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a>&#160;</td>
          <td class="paramname"><em>debugflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="dewarp_8c.html#a7ab5f4edbe5de252b075bb1df2c2770c">dewarpApplyDisparity()</a></p>
<p>Input: dew pixs (image to be modified; can be 1, 8 or 32 bpp) debugflag Return: 0 if OK, 1 on error</p>
<p>Notes: (1) This applies the vertical disparity array to the specified image. For src pixels above the image, we use the pixels in the first raster line. (2) This works with stripped models. If the full resolution disparity array(s) are missing, they are remade. </p>

<p>Definition at line <a class="el" href="dewarp_8c_source.html#l00959">959</a> of file <a class="el" href="dewarp_8c_source.html">dewarp.c</a>.</p>

<p>References <a class="el" href="dewarp_8h_source.html#l00049">L_Dewarp::applyhoriz</a>, <a class="el" href="dewarp_8c_source.html#l01227">dewarpPopulateFullRes()</a>, <a class="el" href="environ_8h_source.html#l00251">ERROR_INT</a>, <a class="el" href="dewarp_8h_source.html#l00052">L_Dewarp::extraw</a>, <a class="el" href="dewarp_8h_source.html#l00043">L_Dewarp::fullhdispar</a>, <a class="el" href="dewarp_8h_source.html#l00042">L_Dewarp::fullvdispar</a>, <a class="el" href="imageio_8h_source.html#l00038">IFF_PNG</a>, <a class="el" href="environ_8h_source.html#l00171">NULL</a>, <a class="el" href="dewarp_8c_source.html#l01105">pixApplyHorizontalDisparity()</a>, <a class="el" href="dewarp_8c_source.html#l01016">pixApplyVerticalDisparity()</a>, <a class="el" href="dewarp_8h_source.html#l00039">L_Dewarp::pixd</a>, <a class="el" href="pix1_8c_source.html#l00466">pixDestroy()</a>, <a class="el" href="writefile_8c_source.html#l00699">pixDisplayWithTitle()</a>, <a class="el" href="writefile_8c_source.html#l00434">pixWriteTempfile()</a>, <a class="el" href="environ_8h_source.html#l00249">PROCNAME</a>, and <a class="el" href="dewarp_8h_source.html#l00053">L_Dewarp::success</a>.</p>

<p>Referenced by <a class="el" href="dewarp__reg_8c_source.html#l00027">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a2b40c78dd875eec3980384cc6e5673e7"></a><!-- doxytag: member="dewarp.c::pixApplyVerticalDisparity" ref="a2b40c78dd875eec3980384cc6e5673e7" args="(PIX *pixs, FPIX *fpix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_pix.html">PIX</a>* pixApplyVerticalDisparity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_pix.html">PIX</a> *&#160;</td>
          <td class="paramname"><em>pixs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_f_pix.html">FPIX</a> *&#160;</td>
          <td class="paramname"><em>fpix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="dewarp_8c.html#a2b40c78dd875eec3980384cc6e5673e7">pixApplyVerticalDisparity()</a></p>
<p>Input: pixs (1, 8 or 32 bpp) fpix (vertical disparity array) Return: pixd (modified by fpix), or null on error</p>
<p>Notes: (1) This applies the vertical disparity array to the specified image. For src pixels above the image, we use the pixels in the first raster line. </p>

<p>Definition at line <a class="el" href="dewarp_8c_source.html#l01016">1016</a> of file <a class="el" href="dewarp_8c_source.html">dewarp.c</a>.</p>

<p>References <a class="el" href="environ_8h_source.html#l00250">ERROR_PTR</a>, <a class="el" href="fpix1_8c_source.html#l00499">fpixGetData()</a>, <a class="el" href="fpix1_8c_source.html#l00365">fpixGetDimensions()</a>, <a class="el" href="fpix1_8c_source.html#l00402">fpixGetWpl()</a>, <a class="el" href="environ_8h_source.html#l00216">FREE</a>, <a class="el" href="arrayaccess_8h_source.html#l00060">GET_DATA_BIT</a>, <a class="el" href="arrayaccess_8h_source.html#l00118">GET_DATA_BYTE</a>, <a class="el" href="arrayaccess_8h_source.html#l00154">GET_DATA_FOUR_BYTES</a>, <a class="el" href="environ_8h_source.html#l00171">NULL</a>, <a class="el" href="pix1_8c_source.html#l00328">pixCreateTemplate()</a>, <a class="el" href="pix1_8c_source.html#l01358">pixGetData()</a>, <a class="el" href="pix1_8c_source.html#l00898">pixGetDimensions()</a>, <a class="el" href="pix1_8c_source.html#l01527">pixGetLinePtrs()</a>, <a class="el" href="pix1_8c_source.html#l00970">pixGetWpl()</a>, <a class="el" href="environ_8h_source.html#l00249">PROCNAME</a>, <a class="el" href="arrayaccess_8h_source.html#l00063">SET_DATA_BIT</a>, and <a class="el" href="arrayaccess_8h_source.html#l00126">SET_DATA_BYTE</a>.</p>

<p>Referenced by <a class="el" href="dewarp_8c_source.html#l00959">dewarpApplyDisparity()</a>.</p>

</div>
</div>
<a class="anchor" id="a5edd9b5fe8990c008d062404cad63c9f"></a><!-- doxytag: member="dewarp.c::pixApplyHorizontalDisparity" ref="a5edd9b5fe8990c008d062404cad63c9f" args="(PIX *pixs, FPIX *fpix, l_int32 extraw)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_pix.html">PIX</a>* pixApplyHorizontalDisparity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_pix.html">PIX</a> *&#160;</td>
          <td class="paramname"><em>pixs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_f_pix.html">FPIX</a> *&#160;</td>
          <td class="paramname"><em>fpix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a>&#160;</td>
          <td class="paramname"><em>extraw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="dewarp_8c.html#a5edd9b5fe8990c008d062404cad63c9f">pixApplyHorizontalDisparity()</a></p>
<p>Input: pixs (1, 8 or 32 bpp) fpix (horizontal disparity array) extraw (extra width added to pixd) Return: pixd (modified by fpix), or null on error</p>
<p>Notes: (1) This applies the horizontal disparity array to the specified image. </p>

<p>Definition at line <a class="el" href="dewarp_8c_source.html#l01105">1105</a> of file <a class="el" href="dewarp_8c_source.html">dewarp.c</a>.</p>

<p>References <a class="el" href="environ_8h_source.html#l00250">ERROR_PTR</a>, <a class="el" href="fpix1_8c_source.html#l00499">fpixGetData()</a>, <a class="el" href="fpix1_8c_source.html#l00365">fpixGetDimensions()</a>, <a class="el" href="fpix1_8c_source.html#l00402">fpixGetWpl()</a>, <a class="el" href="arrayaccess_8h_source.html#l00060">GET_DATA_BIT</a>, <a class="el" href="arrayaccess_8h_source.html#l00118">GET_DATA_BYTE</a>, <a class="el" href="environ_8h_source.html#l00171">NULL</a>, <a class="el" href="pix1_8c_source.html#l00269">pixCreate()</a>, <a class="el" href="pix1_8c_source.html#l01358">pixGetData()</a>, <a class="el" href="pix1_8c_source.html#l00898">pixGetDimensions()</a>, <a class="el" href="pix1_8c_source.html#l00970">pixGetWpl()</a>, <a class="el" href="environ_8h_source.html#l00249">PROCNAME</a>, <a class="el" href="arrayaccess_8h_source.html#l00063">SET_DATA_BIT</a>, and <a class="el" href="arrayaccess_8h_source.html#l00126">SET_DATA_BYTE</a>.</p>

<p>Referenced by <a class="el" href="dewarp_8c_source.html#l00959">dewarpApplyDisparity()</a>.</p>

</div>
</div>
<a class="anchor" id="ab1069c27323d07e4dddab5f3de59fa0e"></a><!-- doxytag: member="dewarp.c::dewarpMinimize" ref="ab1069c27323d07e4dddab5f3de59fa0e" args="(L_DEWARP *dew)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a> dewarpMinimize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_l___dewarp.html">L_DEWARP</a> *&#160;</td>
          <td class="paramname"><em>dew</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="dewarp_8c.html#ab1069c27323d07e4dddab5f3de59fa0e">dewarpMinimize()</a></p>
<p>Input: dew Return: 0 if OK, 1 on error</p>
<p>Notes: (1) This removes all data that is not needed for serialization. It keeps the subsampled disparity array(s), so the full resolution arrays can be reconstructed. </p>

<p>Definition at line <a class="el" href="dewarp_8c_source.html#l01198">1198</a> of file <a class="el" href="dewarp_8c_source.html">dewarp.c</a>.</p>

<p>References <a class="el" href="environ_8h_source.html#l00251">ERROR_INT</a>, <a class="el" href="fpix1_8c_source.html#l00326">fpixDestroy()</a>, <a class="el" href="dewarp_8h_source.html#l00043">L_Dewarp::fullhdispar</a>, <a class="el" href="dewarp_8h_source.html#l00042">L_Dewarp::fullvdispar</a>, <a class="el" href="dewarp_8h_source.html#l00045">L_Dewarp::nacurves</a>, <a class="el" href="dewarp_8h_source.html#l00044">L_Dewarp::naflats</a>, <a class="el" href="numabasic_8c_source.html#l00292">numaDestroy()</a>, <a class="el" href="dewarp_8h_source.html#l00039">L_Dewarp::pixd</a>, <a class="el" href="pix1_8c_source.html#l00466">pixDestroy()</a>, <a class="el" href="dewarp_8h_source.html#l00038">L_Dewarp::pixs</a>, and <a class="el" href="environ_8h_source.html#l00249">PROCNAME</a>.</p>

<p>Referenced by <a class="el" href="dewarp__reg_8c_source.html#l00027">main()</a>.</p>

</div>
</div>
<a class="anchor" id="ab7e72e62f5ca0fbbbc4416cb0066cc26"></a><!-- doxytag: member="dewarp.c::dewarpPopulateFullRes" ref="ab7e72e62f5ca0fbbbc4416cb0066cc26" args="(L_DEWARP *dew)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a> dewarpPopulateFullRes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_l___dewarp.html">L_DEWARP</a> *&#160;</td>
          <td class="paramname"><em>dew</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="dewarp_8c.html#ab7e72e62f5ca0fbbbc4416cb0066cc26">dewarpPopulateFullRes()</a></p>
<p>Input: dew Return: 0 if OK, 1 on error</p>
<p>Notes: (1) If the full resolution vertical (and, optionally horizontal) disparity arrays do not exist, they are built from the subsampled ones. </p>

<p>Definition at line <a class="el" href="dewarp_8c_source.html#l01227">1227</a> of file <a class="el" href="dewarp_8c_source.html">dewarp.c</a>.</p>

<p>References <a class="el" href="environ_8h_source.html#l00251">ERROR_INT</a>, <a class="el" href="fpix2_8c_source.html#l00785">fpixScaleByInteger()</a>, <a class="el" href="dewarp_8h_source.html#l00043">L_Dewarp::fullhdispar</a>, <a class="el" href="dewarp_8h_source.html#l00042">L_Dewarp::fullvdispar</a>, <a class="el" href="environ_8h_source.html#l00249">PROCNAME</a>, <a class="el" href="dewarp_8h_source.html#l00041">L_Dewarp::samphdispar</a>, <a class="el" href="dewarp_8h_source.html#l00047">L_Dewarp::sampling</a>, and <a class="el" href="dewarp_8h_source.html#l00040">L_Dewarp::sampvdispar</a>.</p>

<p>Referenced by <a class="el" href="dewarp_8c_source.html#l00959">dewarpApplyDisparity()</a>.</p>

</div>
</div>
<a class="anchor" id="afd745d76986778386eeaef73715ac584"></a><!-- doxytag: member="dewarp.c::dewarpRead" ref="afd745d76986778386eeaef73715ac584" args="(const char *filename)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_l___dewarp.html">L_DEWARP</a>* dewarpRead </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="dewarp_8c.html#afd745d76986778386eeaef73715ac584">dewarpRead()</a></p>
<p>Input: filename Return: dew, or null on error </p>

<p>Definition at line <a class="el" href="dewarp_8c_source.html#l01256">1256</a> of file <a class="el" href="dewarp_8c_source.html">dewarp.c</a>.</p>

<p>References <a class="el" href="dewarp_8c_source.html#l01289">dewarpReadStream()</a>, <a class="el" href="environ_8h_source.html#l00250">ERROR_PTR</a>, <a class="el" href="utils_8c_source.html#l01953">fopenReadStream()</a>, <a class="el" href="environ_8h_source.html#l00171">NULL</a>, and <a class="el" href="environ_8h_source.html#l00249">PROCNAME</a>.</p>

<p>Referenced by <a class="el" href="dewarp__reg_8c_source.html#l00027">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a7c42c5bade33d41e4ce249a3b2dc914a"></a><!-- doxytag: member="dewarp.c::dewarpReadStream" ref="a7c42c5bade33d41e4ce249a3b2dc914a" args="(FILE *fp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_l___dewarp.html">L_DEWARP</a>* dewarpReadStream </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="dewarp_8c.html#a7c42c5bade33d41e4ce249a3b2dc914a">dewarpReadStream()</a></p>
<p>Input: stream Return: dew, or null on error</p>
<p>Notes: (1) The dewarp struct is stored in minimized format, with only subsampled disparity arrays. </p>

<p>Definition at line <a class="el" href="dewarp_8c_source.html#l01289">1289</a> of file <a class="el" href="dewarp_8c_source.html">dewarp.c</a>.</p>

<p>References <a class="el" href="dewarp_8h_source.html#l00049">L_Dewarp::applyhoriz</a>, <a class="el" href="environ_8h_source.html#l00214">CALLOC</a>, <a class="el" href="dewarp_8h_source.html#l00034">DEWARP_VERSION_NUMBER</a>, <a class="el" href="environ_8h_source.html#l00250">ERROR_PTR</a>, <a class="el" href="fpix1_8c_source.html#l01489">fpixReadStream()</a>, <a class="el" href="environ_8h_source.html#l00171">NULL</a>, <a class="el" href="dewarp_8h_source.html#l00050">L_Dewarp::nx</a>, <a class="el" href="pixaatest_8c_source.html#l00026">nx</a>, <a class="el" href="dewarp_8h_source.html#l00051">L_Dewarp::ny</a>, <a class="el" href="pixaatest_8c_source.html#l00027">ny</a>, <a class="el" href="dewarp_8h_source.html#l00046">L_Dewarp::pageno</a>, <a class="el" href="environ_8h_source.html#l00249">PROCNAME</a>, <a class="el" href="dewarp_8h_source.html#l00041">L_Dewarp::samphdispar</a>, <a class="el" href="dewarp_8h_source.html#l00047">L_Dewarp::sampling</a>, <a class="el" href="dewarp_8h_source.html#l00040">L_Dewarp::sampvdispar</a>, <a class="el" href="dewarp_8h_source.html#l00053">L_Dewarp::success</a>, and <a class="el" href="src_2xtractprotos_8c_source.html#l00053">version</a>.</p>

<p>Referenced by <a class="el" href="dewarp_8c_source.html#l01256">dewarpRead()</a>.</p>

</div>
</div>
<a class="anchor" id="ac6089601d0fd423363c5f53cb610df61"></a><!-- doxytag: member="dewarp.c::dewarpWrite" ref="ac6089601d0fd423363c5f53cb610df61" args="(const char *filename, L_DEWARP *dew)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a> dewarpWrite </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_l___dewarp.html">L_DEWARP</a> *&#160;</td>
          <td class="paramname"><em>dew</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="dewarp_8c.html#ac6089601d0fd423363c5f53cb610df61">dewarpWrite()</a></p>
<p>Input: filename dew Return: 0 if OK, 1 on error </p>

<p>Definition at line <a class="el" href="dewarp_8c_source.html#l01341">1341</a> of file <a class="el" href="dewarp_8c_source.html">dewarp.c</a>.</p>

<p>References <a class="el" href="dewarp_8c_source.html#l01371">dewarpWriteStream()</a>, <a class="el" href="environ_8h_source.html#l00251">ERROR_INT</a>, <a class="el" href="utils_8c_source.html#l01993">fopenWriteStream()</a>, <a class="el" href="environ_8h_source.html#l00171">NULL</a>, and <a class="el" href="environ_8h_source.html#l00249">PROCNAME</a>.</p>

<p>Referenced by <a class="el" href="dewarp__reg_8c_source.html#l00027">main()</a>.</p>

</div>
</div>
<a class="anchor" id="aa8e412e6989ef5bb3893feba8e959fd2"></a><!-- doxytag: member="dewarp.c::dewarpWriteStream" ref="aa8e412e6989ef5bb3893feba8e959fd2" args="(FILE *fp, L_DEWARP *dew)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a> dewarpWriteStream </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_l___dewarp.html">L_DEWARP</a> *&#160;</td>
          <td class="paramname"><em>dew</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="dewarp_8c.html#aa8e412e6989ef5bb3893feba8e959fd2">dewarpWriteStream()</a></p>
<p>Input: stream (opened for "wb") dew Return: 0 if OK, 1 on error </p>

<p>Definition at line <a class="el" href="dewarp_8c_source.html#l01371">1371</a> of file <a class="el" href="dewarp_8c_source.html">dewarp.c</a>.</p>

<p>References <a class="el" href="dewarp_8h_source.html#l00034">DEWARP_VERSION_NUMBER</a>, <a class="el" href="environ_8h_source.html#l00251">ERROR_INT</a>, <a class="el" href="fpix1_8c_source.html#l01557">fpixWriteStream()</a>, <a class="el" href="dewarp_8h_source.html#l00050">L_Dewarp::nx</a>, <a class="el" href="dewarp_8h_source.html#l00051">L_Dewarp::ny</a>, <a class="el" href="dewarp_8h_source.html#l00046">L_Dewarp::pageno</a>, <a class="el" href="environ_8h_source.html#l00249">PROCNAME</a>, <a class="el" href="dewarp_8h_source.html#l00041">L_Dewarp::samphdispar</a>, <a class="el" href="dewarp_8h_source.html#l00047">L_Dewarp::sampling</a>, and <a class="el" href="dewarp_8h_source.html#l00040">L_Dewarp::sampvdispar</a>.</p>

<p>Referenced by <a class="el" href="dewarp_8c_source.html#l01341">dewarpWrite()</a>.</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="ad793119b763d335646cb5f46c3be0554"></a><!-- doxytag: member="dewarp.c::L_DEFAULT_SAMPLING" ref="ad793119b763d335646cb5f46c3be0554" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="environ_8h.html#a9085c7874153c280a4171244aa052e4e">l_int32</a> <a class="el" href="dewarp_8c.html#ad793119b763d335646cb5f46c3be0554">L_DEFAULT_SAMPLING</a> = 30<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="dewarp_8c_source.html#l00233">233</a> of file <a class="el" href="dewarp_8c_source.html">dewarp.c</a>.</p>

<p>Referenced by <a class="el" href="dewarp_8c_source.html#l00261">dewarpCreate()</a>.</p>

</div>
</div>
<a class="anchor" id="a8ac2b65653d2154442628d17fcd15113"></a><!-- doxytag: member="dewarp.c::DEFAULT_SLOPE_FACTOR" ref="a8ac2b65653d2154442628d17fcd15113" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="environ_8h.html#af59419416d96ecf5fca70c8d05adb456">l_float32</a> <a class="el" href="dewarp_8c.html#a8ac2b65653d2154442628d17fcd15113">DEFAULT_SLOPE_FACTOR</a> = 2000.<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="dewarp_8c_source.html#l00234">234</a> of file <a class="el" href="dewarp_8c_source.html">dewarp.c</a>.</p>

<p>Referenced by <a class="el" href="dewarp_8c_source.html#l00818">fpixBuildHorizontalDisparity()</a>.</p>

</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dewarp_8c.html">dewarp.c</a>      </li>
      <li class="footer">Generated by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </li>
    </ul>
  </div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


</body>
</html>
